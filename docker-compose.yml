version: '3.8'

services:
  # 1. ë°±ì—”ë“œ ì„œë¹„ìŠ¤
  backend:
    build: ./backend
    container_name: cdc-backend
    restart: always
    volumes:
      - ./backend_data:/app/data
    expose:
      # - "8000"
      - "7676"
    # ğŸ”¥ [í•µì‹¬ 1] ì™¸ë¶€ vLLM ì„œë²„ ì ‘ì† ì •ë³´ ì£¼ì…
    environment:
      - VLLM_API_BASE=http://10.23.80.35:8881/v1
      - VLLM_MODEL_NAME=llama-hist
      # í•„ìš” ì‹œ OPENAI_API_KEY ë“±ë„ ì—¬ê¸°ì— ì¶”ê°€
      # - OPENAI_API_KEY=sk-xxxx... 

  # 2. í”„ë¡ íŠ¸ì—”ë“œ ì„œë¹„ìŠ¤ (Nginx)
  frontend:
    build: ./frontend
    container_name: cdc-frontend
    restart: always
    ports:
      # ğŸ”¥ [í•µì‹¬ 2] ì™¸ë¶€(Host) 1577 í¬íŠ¸ë¥¼ ë‚´ë¶€ 80 í¬íŠ¸ë¡œ ì—°ê²°
      # ì´ì œ ë¸Œë¼ìš°ì €ì—ì„œ http://10.23.80.35:1577 ë¡œ ì ‘ì† ê°€ëŠ¥
      - "5173:80"
    depends_on:
      - backend
